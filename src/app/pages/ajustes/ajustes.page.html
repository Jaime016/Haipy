<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Configuraci贸n</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <!--  CABECERA DE PERFIL -->
  <div class="perfil-header">
    <img
      [src]="imagenPerfil || 'assets/default-avatar.png'"
      alt="Imagen de perfil"
      class="perfil-img"
      (click)="cambiarImagen()"
    />
    <h2>{{ nombreUsuario || 'Usuario invitado' }}</h2>
    <p>{{ correoUsuario || 'Inici谩 sesi贸n para sincronizar tus notas' }}</p>
    <ion-button fill="clear" color="light" (click)="cambiarImagen()">
      Cambiar imagen
    </ion-button>
  </div>

  <!--  CUENTA DE USUARIO -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Cuenta</ion-card-title>
      <ion-card-subtitle>Gesti贸n de acceso</ion-card-subtitle>
    </ion-card-header>

    <ion-card-content>
      <!-- Solo se muestran si no hay usuario logueado -->
      <div *ngIf="!nombreUsuario">

        <!-- Bot贸n Iniciar sesi贸n -->
        <div>
          <ion-button expand="block" color="primary" (click)="mostrarLogin = !mostrarLogin; mostrarRegistro = false;">
            Iniciar sesi贸n
          </ion-button>

          <!-- Formulario de login debajo del bot贸n -->
          <div *ngIf="mostrarLogin" class="login-form" style="margin-top: 10px;">
            <ion-input placeholder="Correo" [(ngModel)]="correoLogin" type="email"></ion-input>
            <ion-input placeholder="Contrase帽a" [(ngModel)]="contrasenaLogin" type="password"></ion-input>
            <ion-button expand="block" color="primary" (click)="loguearUsuario()">Entrar</ion-button>
          </div>
        </div>

        <!-- Bot贸n Crear cuenta -->
        <div style="margin-top: 15px;">
          <ion-button expand="block" color="primary" (click)="mostrarRegistro = !mostrarRegistro; mostrarLogin = false;">
            Crear cuenta
          </ion-button>

          <!-- Formulario de registro debajo del bot贸n -->
          <div *ngIf="mostrarRegistro" class="registro-form" style="margin-top: 10px;">
            <ion-input placeholder="Nombre" [(ngModel)]="nombreRegistro"></ion-input>
            <ion-input placeholder="Correo" [(ngModel)]="correoRegistro" type="email"></ion-input>
            <ion-input placeholder="Contrase帽a" [(ngModel)]="contrasenaRegistro" type="password"></ion-input>
            <ion-button expand="block" color="primary" (click)="crearCuenta()">Crear cuenta</ion-button>
          </div>
        </div>

        <!-- Bot贸n Google siempre visible mientras no hay usuario -->
        <div style="margin-top: 15px;">
          <ion-button expand="block" color="danger" fill="clear" (click)="loginConGoogle()">
            <ion-icon name="logo-google" slot="start"></ion-icon>
            Iniciar con Google
          </ion-button>
        </div>
      </div> <!-- FIN *ngIf="!nombreUsuario" -->
    </ion-card-content>
  </ion-card>

  <!--  OPCIONES DE NOTAS -->
  <ion-list inset>
    <ion-list-header>
      <ion-label>Gesti贸n de notas</ion-label>
    </ion-list-header>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Exportar / Importar Notas</ion-card-title>
        <ion-card-subtitle>Respald谩 tus notas de Haipy</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <ion-button expand="block" color="primary" (click)="exportarNotasJSON()">
          Exportar notas (JSON)
        </ion-button>

        <ion-button expand="block" color="secondary" (click)="exportarNotasPDF()">
          Exportar notas (PDF)
        </ion-button>

        <ion-button expand="block" color="tertiary" (click)="fileInput.click()">
          Importar notas (JSON)
        </ion-button>

        <input type="file" #fileInput (change)="importarNotasJSON($event)" hidden accept=".json">
      </ion-card-content>
    </ion-card>

    <ion-item button detail (click)="abrirFavoritos()">
      <ion-icon slot="start" name="star-outline"></ion-icon>
      <ion-label>Notas favoritas</ion-label>
    </ion-item>

    <ion-item button detail (click)="abrirPapelera()">
      <ion-icon slot="start" name="trash-outline"></ion-icon>
      <ion-label>Papelera</ion-label>
    </ion-item>
  </ion-list>

  <!--  PERSONALIZACIN -->
  <ion-list inset>
    <ion-list-header>
      <ion-label>Personalizaci贸n</ion-label>
    </ion-list-header>

    <!-- Toggle Modo oscuro -->
    <ion-item lines="none">
      <ion-icon name="moon-outline" slot="start"></ion-icon>
      <ion-label>Modo oscuro</ion-label>
      <ion-toggle [(ngModel)]="modoOscuro" (ionChange)="toggleTema()"></ion-toggle>
    </ion-item>

    <!-- Estilo de visualizaci贸n -->
    <ion-item lines="none">
      <ion-icon slot="start" name="grid-outline"></ion-icon>
      <ion-label>Estilo de visualizaci贸n</ion-label>
    </ion-item>

    <!--  OPCIONES VISUALES -->
    <div class="vista-opciones">
      <ion-card
        class="opcion"
        [class.seleccionado]="estiloVista === 'lista'"
        (click)="cambiarEstilo('lista')"
      >
        <ion-icon name="list-outline"></ion-icon>
        <p>Lista</p>
      </ion-card>

      <ion-card
        class="opcion"
        [class.seleccionado]="estiloVista === 'cuadricula'"
        (click)="cambiarEstilo('cuadricula')"
      >
        <ion-icon name="grid-outline"></ion-icon>
        <p>Cuadr铆cula</p>
      </ion-card>
    </div>
  </ion-list>

  <!--  CERRAR SESIN -->
  <ion-button expand="block" color="medium" fill="outline" (click)="cerrarSesion()">
    <ion-icon name="log-out-outline" slot="start"></ion-icon>
    Cerrar sesi贸n
  </ion-button>

  <!--  ACERCA DE -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Acerca de Haipy</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <p><strong>Versi贸n de la aplicaci贸n:</strong> 1.0.0</p>
      <p>
        <strong>Descripci贸n:</strong> Haipy es un sistema de gesti贸n de notas dise帽ado para ofrecer una experiencia segura y eficiente, permitiendo al usuario organizar, almacenar y exportar sus notas de manera r谩pida y confiable.
      </p>
      <p>
        <strong>T茅rminos y condiciones:</strong>
        <a href="https://www.haipy.com/terminos" target="_blank">Consultar t茅rminos y condiciones</a>
      </p>
      <p>
        <strong>Pol铆tica de privacidad:</strong>
        <a href="https://www.haipy.com/privacidad" target="_blank">Consultar pol铆tica de privacidad</a>
      </p>
      <p>
        <strong>Contacto y soporte:</strong> soporte@haipy.com
      </p>

      <ion-button expand="block" color="danger" fill="outline" (click)="reportarBug()">
        Reportar
      </ion-button>
    </ion-card-content>
  </ion-card>

</ion-content>
